<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åšæˆ‘å¥³æœ‹å‹å¥½ä¸å¥½ï¼ŸğŸ’•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Microsoft YaHei', -apple-system, BlinkMacSystemFont, sans-serif;
            overflow: hidden;
            position: relative;
            transition: background 0.5s ease;
        }

        .container {
            text-align: center;
            z-index: 10;
            position: relative;
            padding: 20px;
            width: 100%;
            max-width: 600px;
        }

        .question {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            color: #fff;
            margin-bottom: 40px;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.3);
            animation: pulse 2s ease-in-out infinite;
            line-height: 1.5;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }

        .buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
            position: relative;
            min-height: 100px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 35px;
            font-size: clamp(0.9rem, 3vw, 1.2rem);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            position: absolute;
            white-space: nowrap;
            touch-action: manipulation;
        }

        .btn-yes {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            color: white;
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.5);
            left: 50%;
            transform: translateX(-130%);
        }

        .btn-yes:hover {
            box-shadow: 0 8px 30px rgba(255, 107, 107, 0.7);
        }

        .btn-no {
            background: linear-gradient(45deg, #a8a8a8, #c0c0c0);
            color: white;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            left: 50%;
            transform: translateX(30%);
            transition: all 0.1s ease;
        }

        .success-message {
            display: none;
            flex-direction: column;
            align-items: center;
            animation: fadeIn 0.5s ease;
            padding: 20px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .success-message h2 {
            font-size: clamp(1.3rem, 4vw, 2rem);
            color: #fff;
            margin-bottom: 20px;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.3);
            line-height: 1.5;
        }

        .success-message p {
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: #ffe4e1;
            line-height: 1.6;
        }

        .heart, .star, .confetti, .bubble, .snow, .petal, .meteor, .firework {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
        }

        .heart { font-size: 20px; animation: fall linear forwards; }
        @keyframes fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        .star {
            width: 3px; height: 3px; background: white; border-radius: 50%;
            animation: twinkle 2s ease-in-out infinite;
        }
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5); }
        }

        .confetti {
            width: 10px; height: 10px;
            animation: confetti-fall 3s ease forwards;
        }
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(1080deg); opacity: 0; }
        }

        .bubble {
            width: 20px; height: 20px; border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8), rgba(255,255,255,0.2));
            animation: bubble-rise 4s ease forwards;
        }
        @keyframes bubble-rise {
            0% { transform: translateY(100vh) scale(0); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: translateY(-100px) scale(1); opacity: 0; }
        }

        .snow {
            color: white; font-size: 15px;
            animation: snow-fall linear forwards;
        }
        @keyframes snow-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0.3; }
        }

        .petal {
            font-size: 18px;
            animation: petal-fall linear forwards;
        }
        @keyframes petal-fall {
            0% { transform: translateY(-100vh) rotate(0deg) translateX(0); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg) translateX(100px); opacity: 0; }
        }

        .meteor {
            width: 2px; height: 80px;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,1));
            animation: meteor-fall 1s linear forwards;
        }
        @keyframes meteor-fall {
            0% { transform: translateY(-100px) translateX(0) rotate(-45deg); opacity: 1; }
            100% { transform: translateY(100vh) translateX(100px) rotate(-45deg); opacity: 0; }
        }

        .firework {
            width: 5px; height: 5px; border-radius: 50%;
            animation: firework-explode 1s ease forwards;
        }
        @keyframes firework-explode {
            0% { transform: scale(0); opacity: 1; }
            50% { transform: scale(20); opacity: 0.8; }
            100% { transform: scale(30); opacity: 0; }
        }

        .emoji-burst {
            position: fixed; font-size: 30px;
            animation: burst 1s ease forwards;
            pointer-events: none; z-index: 1000;
        }
        @keyframes burst {
            0% { transform: scale(0) rotate(0deg); opacity: 1; }
            100% { transform: scale(2) rotate(360deg); opacity: 0; }
        }

        .counter {
            position: fixed;
            bottom: 20px; right: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px; border-radius: 20px;
            color: white; font-size: 0.85rem;
            backdrop-filter: blur(10px); z-index: 100;
        }

        .hint {
            position: fixed;
            top: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px; border-radius: 20px;
            color: white; font-size: 0.95rem;
            backdrop-filter: blur(10px);
            animation: bounce 2s ease infinite; z-index: 100;
            max-width: 90%; text-align: center;
        }
        @keyframes bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }

        .rainbow-bg { animation: rainbow 5s linear infinite; }
        @keyframes rainbow { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }

        .lightning {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; opacity: 0;
            pointer-events: none; z-index: 999;
        }
        .lightning.flash { animation: lightning-flash 0.2s ease; }
        @keyframes lightning-flash { 0%, 100% { opacity: 0; } 50% { opacity: 0.8; } }

        .admin-link {
            position: fixed;
            bottom: 20px; left: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px; border-radius: 15px;
            color: white; font-size: 0.8rem;
            text-decoration: none;
            backdrop-filter: blur(10px); z-index: 100;
            transition: all 0.3s;
        }
        .admin-link:hover { background: rgba(255, 255, 255, 0.3); }

        .btn-cry { animation: cry 0.5s ease infinite; }
        @keyframes cry {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        .btn-invert { filter: invert(1); }

        .shake { animation: shake 0.5s ease; }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-10px); }
            40% { transform: translateX(10px); }
            60% { transform: translateX(-10px); }
            80% { transform: translateX(10px); }
        }

        /* æ¸è¿›éœ‡åŠ¨åŠ¨ç”» */
        @keyframes shake-1 { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        @keyframes shake-2 { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }
        @keyframes shake-3 { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-12px); } 50% { transform: translateX(12px); } 75% { transform: translateX(-12px); } }
        @keyframes shake-4 { 0%, 100% { transform: translateX(0); } 20% { transform: translateX(-15px); } 40% { transform: translateX(15px); } 60% { transform: translateX(-15px); } 80% { transform: translateX(15px); } }
        @keyframes shake-5 { 0%, 100% { transform: translateX(0) rotate(0deg); } 20% { transform: translateX(-20px) rotate(-2deg); } 40% { transform: translateX(20px) rotate(2deg); } 60% { transform: translateX(-20px) rotate(-2deg); } 80% { transform: translateX(20px) rotate(2deg); } }

        @media (max-width: 480px) {
            .buttons { gap: 15px; min-height: 120px; }
            .btn { padding: 14px 26px; font-size: 1rem; }
            .btn-yes { transform: translateX(-120%); }
            .btn-no { transform: translateX(20%); }
            .counter, .admin-link { bottom: 12px; }
            .counter { right: 12px; }
            .admin-link { left: 12px; }
        }
    </style>
</head>
<body>
    <div class="lightning" id="lightning"></div>
    <div class="hint" id="hint">ğŸ’¡ æ‰‹æœºå¯ç‚¹æŒ‰ / é•¿æŒ‰ / å·¦æ»‘è¯•è¯•"æ‹’ç»"æŒ‰é’®~</div>
    
    <div class="container">
        <div id="question-section">
            <h1 class="question" id="questionText">åšæˆ‘å¥³æœ‹å‹å¥½ä¸å¥½ï¼ŸğŸ’•</h1>
            <div class="buttons">
                <button class="btn btn-yes" id="yesBtn">åŒæ„ â¤ï¸</button>
                <button class="btn btn-no" id="noBtn">æ‹’ç» ğŸ˜¢</button>
            </div>
        </div>
        
        <div class="success-message" id="success">
            <h2 id="successTitle">ğŸ‰ è€¶ï¼æˆ‘å°±çŸ¥é“ä½ ä¼šåŒæ„çš„ï¼ğŸ‰</h2>
            <p id="successMessage">å·¥èµ„ä¸Šäº¤ï¼Œå®¶åŠ¡å…¨åŒ…ï¼â¤ï¸</p>
            <p style="margin-top: 20px; font-size: 1rem;" id="attemptsText">ä½ å°è¯•äº†æ‹’ç» <span id="attempts">0</span> æ¬¡ï¼Œä½†æœ€ç»ˆè¿˜æ˜¯è¢«æˆ‘çš„è¯šæ„æ‰“åŠ¨å•¦~</p>
        </div>
    </div>
    
    <div class="counter" id="counter">æ‹’ç»å°è¯•æ¬¡æ•°: 0</div>
    <a href="admin.html" class="admin-link" target="_blank">âš™ï¸ é…ç½®ä¸­å¿ƒ</a>

    <!-- å°è¯•ä»CDNåŠ è½½LZStringå‹ç¼©åº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.5.0/lz-string.min.js"></script>
    <script>
        // å¦‚æœCDNåŠ è½½å¤±è´¥ï¼Œä½¿ç”¨ UTF-8 å®‰å…¨çš„ Base64 å›é€€æ–¹æ¡ˆï¼ˆé¿å… escape/unescapeï¼‰
        if (typeof LZString === 'undefined') {
            const utf8ToBase64 = (str) => {
                const bytes = new TextEncoder().encode(str);
                let binary = '';
                for (const b of bytes) binary += String.fromCharCode(b);
                return btoa(binary);
            };

            const base64ToUtf8 = (b64) => {
                const binary = atob(b64);
                const bytes = Uint8Array.from(binary, c => c.charCodeAt(0));
                return new TextDecoder().decode(bytes);
            };

            LZString = {
                compressToEncodedURIComponent(input) {
                    if (input == null) return "";
                    const encoded = utf8ToBase64(String(input));
                    return encoded.replace(/\+/g, '-').replace(/\//g, '_').replace(/=/g, '');
                },
                decompressFromEncodedURIComponent(input) {
                    if (input == null || input === "") return null;
                    try {
                        input = input.replace(/-/g, '+').replace(/_/g, '/');
                        while (input.length % 4) input += '=';
                        return base64ToUtf8(input);
                    } catch (e) {
                        return null;
                    }
                }
            };
        }
        
        /** é»˜è®¤é…ç½® */
        const defaultConfig = {
            question: "åšæˆ‘å¥³æœ‹å‹å¥½ä¸å¥½ï¼ŸğŸ’•",
            yesText: "åŒæ„ â¤ï¸",
            noText: "æ‹’ç» ğŸ˜¢",
            successTitle: "ğŸ‰ è€¶ï¼æˆ‘å°±çŸ¥é“ä½ ä¼šåŒæ„çš„ï¼ğŸ‰",
            successMessage: "å·¥èµ„ä¸Šäº¤ï¼Œå®¶åŠ¡å…¨åŒ…ï¼â¤ï¸",
            hints: [
                "ğŸ’¡ è¯•è¯•ç‚¹å‡»\"æ‹’ç»\"æŒ‰é’®çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ~",
                "ğŸ˜ æƒ³è·‘ï¼Ÿæ²¡é‚£ä¹ˆå®¹æ˜“ï¼",
                "ğŸ¤­ åˆ«æŒ£æ‰äº†ï¼Œæ²¡ç”¨çš„~",
                "ğŸ˜… ä½ å·²ç»å°è¯• {attempts} æ¬¡äº†å“¦~",
                "ğŸ¥º ç»™æˆ‘ä¸€ä¸ªæœºä¼šå˜›~",
                "ğŸ’• æˆ‘ä¼šå¯¹ä½ å¾ˆå¥½çš„ï¼",
                "ğŸ æˆ‘ä¼šç»™ä½ ä¹°å¥½åƒçš„ï¼",
                "ğŸ  æˆ¿äº§è¯å†™ä½ åå­—ï¼",
                "ğŸ’° å·¥èµ„å¡äº¤ç»™ä½ ç®¡ï¼",
                "ğŸ³ æˆ‘ä¼šåšé¥­ç»™ä½ åƒï¼",
                "ğŸ§¹ å®¶åŠ¡æˆ‘å…¨åŒ…äº†ï¼",
                "ğŸ¶ æˆ‘ä¼šåƒå°ç‹—ä¸€æ ·å¬è¯ï¼",
                "ğŸ’ª æˆ‘ä¼šä¿æŠ¤ä½ çš„ï¼",
                "ğŸŒŸ ä½ å°±æ˜¯æˆ‘çš„å°æ˜Ÿæ˜Ÿï¼",
                "ğŸ˜Š ç­”åº”æˆ‘å˜›~"
            ],
            theme: {
                primaryColor: "#667eea",
                secondaryColor: "#764ba2",
                accentColor: "#f093fb",
                yesButtonColor: "#ff6b6b"
            },
            effects: {
                hearts: true, stars: true, confetti: true,
                fireworks: false, bubbles: false, rainbow: false,
                snow: false, petals: false, meteor: false, lightning: false
            },
            triggerEffects: {
                triggerCount: 5,
                avoidDistance: 100,
                shake: true, sound: true, cry: true,
                runaway: true, multiple: true, invert: false
            },
            showAdminLink: true
        };

        /** å…¨å±€å˜é‡ */
        let config = defaultConfig;
        let attempts = 0;
        let effectsStarted = false;
        let yesSize = 1;
        let triggerActivated = false;
        let multipleClones = [];
        let emojiBurstTimeout = null;
        let mouseX = window.innerWidth / 2;
        let mouseY = window.innerHeight / 2;
        let cloneWaveCount = 0;
        const MAX_CLONE_WAVES = 3;
        const isTouchDevice = window.matchMedia('(hover: none), (pointer: coarse)').matches || 'ontouchstart' in window;
        const ESCAPE_COOLDOWN_MS = isTouchDevice ? 180 : 80;
        let lastEscapeAt = 0;
        const MAX_YES_SCALE = isTouchDevice ? 2.6 : 4;
        const LONG_PRESS_MS = 550;
        const SWIPE_THRESHOLD = 70;
        let longPressTimer = null;
        let longPressTriggered = false;
        let touchStartX = null;
        let touchStartY = null;
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const counter = document.getElementById('counter');
        const hint = document.getElementById('hint');

        /** åˆå§‹åŒ– */
        function init() {
            cloneWaveCount = 0;
            loadConfig();
            applyConfig();
            setupEvents();
            // ç‰¹æ•ˆå»¶è¿Ÿå¯åŠ¨ï¼Œç­‰ç”¨æˆ·ç¬¬ä¸€æ¬¡æ‹’ç»åå†å¯åŠ¨ï¼Œé¿å…é¡µé¢åŠ è½½æ—¶å¡é¡¿
        }

        /** åŠ è½½é…ç½® */
        function loadConfig() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // é”®ååå‘æ˜ å°„è¡¨
            const REVERSE_KEY_MAP = {
                'q': 'question', 'y': 'yesText', 'n': 'noText', 'st': 'successTitle',
                'sm': 'successMessage', 'h': 'hints', 't': 'theme', 'pc': 'primaryColor',
                'sc': 'secondaryColor', 'ac': 'accentColor', 'ybc': 'yesButtonColor',
                'e': 'effects', 'ht': 'hearts', 'sr': 'stars', 'cf': 'confetti', 'fw': 'fireworks',
                'bb': 'bubbles', 'rb': 'rainbow', 'sn': 'snow', 'pt': 'petals', 'mt': 'meteors',
                'lt': 'lightning', 'te': 'triggerEffects', 'tc': 'triggerCount', 'ad': 'avoidDistance', 'sk': 'shake',
                'sd': 'sound', 'cr': 'cry', 'ra': 'runaway', 'ml': 'multiple', 'iv': 'invert',
                'sal': 'showAdminLink'
            };
            
            // åˆ†äº«é“¾æ¥æ¨¡å¼ (?c=xxxxx) - çŸ­é”®å+LZStringå‹ç¼©çš„é…ç½®
            const configData = urlParams.get('c');
            if (configData) {
                try {
                    // ä½¿ç”¨LZStringè§£å‹
                    const decoded = LZString.decompressFromEncodedURIComponent(configData);
                    
                    if (decoded) {
                        const shortConfig = JSON.parse(decoded);
                        // è¿˜åŸçŸ­é”®åä¸ºå®Œæ•´é”®å
                        const fullConfig = {};
                        for (const [key, value] of Object.entries(shortConfig)) {
                            fullConfig[REVERSE_KEY_MAP[key] || key] = value;
                        }
                        // å…¼å®¹æ—§ç‰ˆçŸ­é”®æ˜ å°„ï¼ˆrunAway -> runawayï¼‰
                        if (fullConfig.runAway !== undefined && fullConfig.runaway === undefined) {
                            fullConfig.runaway = fullConfig.runAway;
                        }
                        if (fullConfig.triggerEffects?.runAway !== undefined && fullConfig.triggerEffects?.runaway === undefined) {
                            fullConfig.triggerEffects.runaway = fullConfig.triggerEffects.runAway;
                        }
                        config = { ...defaultConfig, ...fullConfig };
                        return;
                    }
                } catch (e) { console.error('åˆ†äº«é…ç½®è§£æå¤±è´¥:', e); }
            }
            
            // é¢„è§ˆæ¨¡å¼ (?preview=xxxxx)
            const previewData = urlParams.get('preview');
            if (previewData) {
                try {
                    config = JSON.parse(decodeURIComponent(previewData));
                    return;
                } catch (e) { console.error('é¢„è§ˆé…ç½®è§£æå¤±è´¥:', e); }
            }
            
            // å£ä»¤æ¨¡å¼
            const token = urlParams.get('t');
            if (token) {
                const allConfigs = JSON.parse(localStorage.getItem('loveConfigs') || '{}');
                if (allConfigs[token]) {
                    config = { ...defaultConfig, ...allConfigs[token] };
                    return;
                }
            }
        }

        /** åº”ç”¨é…ç½® */
        function applyConfig() {
            document.getElementById('questionText').textContent = config.question;
            yesBtn.textContent = config.yesText;
            noBtn.textContent = config.noText;
            document.getElementById('successTitle').textContent = config.successTitle;
            document.getElementById('successMessage').textContent = config.successMessage;
            
            if (config.theme) {
                document.body.style.background = `linear-gradient(135deg, ${config.theme.primaryColor} 0%, ${config.theme.secondaryColor} 50%, ${config.theme.accentColor} 100%)`;
                yesBtn.style.background = `linear-gradient(45deg, ${config.theme.yesButtonColor}, ${lightenColor(config.theme.yesButtonColor, 20)})`;
            }
            
            if (config.effects?.rainbow) document.body.classList.add('rainbow-bg');
            
            if (config.showAdminLink === false) {
                document.querySelector('.admin-link').style.display = 'none';
            }
        }

        /** é¢œè‰²å˜äº® */
        function lightenColor(color, percent) {
            const num = parseInt(color.replace('#', ''), 16);
            const amt = Math.round(2.55 * percent);
            const R = Math.min(255, (num >> 16) + amt);
            const G = Math.min(255, ((num >> 8) & 0x00FF) + amt);
            const B = Math.min(255, (num & 0x0000FF) + amt);
            return '#' + (0x1000000 + R * 0x10000 + G * 0x100 + B).toString(16).slice(1);
        }

        /** è®¾ç½®äº‹ä»¶ */
        function setupEvents() {
            yesBtn.addEventListener('click', sayYes);
            // å½“å…³é—­ runAway æ—¶ï¼Œå…è®¸ç‚¹å‡»æ‹’ç»æŒ‰é’®è§¦å‘äº¤äº’
            noBtn.addEventListener('click', handleNoClick);
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('touchstart', handleTouchStart, { passive: false });
            document.addEventListener('touchmove', handleTouchMove, { passive: false });
            document.addEventListener('touchend', handleTouchEnd, { passive: false });
            document.addEventListener('touchcancel', clearLongPress);
        }


        /** æ›´æ–°åŒæ„æŒ‰é’®å°ºå¯¸ï¼ˆç§»åŠ¨ç«¯é™åˆ¶æœ€å¤§ç¼©æ”¾ï¼Œé¿å…æŒ¤å‡ºå±å¹•ï¼‰ */
        function bumpYesButton(delta) {
            yesSize = Math.min(MAX_YES_SCALE, yesSize + delta);
            yesBtn.style.transform = `translateX(-130%) scale(${yesSize})`;
        }


        /** è½»è§¦è§‰åé¦ˆï¼ˆæ”¯æŒè®¾å¤‡æ‰è§¦å‘ï¼‰ */
        function vibrate(duration = 16) {
            if (isTouchDevice && navigator.vibrate) {
                navigator.vibrate(duration);
            }
        }

        function clearLongPress() {
            if (longPressTimer) {
                clearTimeout(longPressTimer);
                longPressTimer = null;
            }
        }

        /** å¤„ç†æ‹’ç»ç‚¹å‡» */
        function handleNoClick() {
            vibrate(12);
            // é¦–æ¬¡æ‹’ç»æ—¶å¯åŠ¨èƒŒæ™¯ç‰¹æ•ˆ
            if (!effectsStarted) {
                effectsStarted = true;
                startEffects();
            }
            
            attempts++;
            counter.textContent = `æ‹’ç»å°è¯•æ¬¡æ•°: ${attempts}`;
            updateHint();
            
            const triggerCount = config.triggerEffects?.triggerCount || 5;
            
            // æ£€æŸ¥æ˜¯å¦æ¿€æ´»è§¦å‘ç‰¹æ•ˆ
            if (attempts >= triggerCount && !triggerActivated) {
                triggerActivated = true;
            }
            
            // è§¦å‘ç‰¹æ•ˆ
            if (triggerActivated) {
                const level = Math.min(5, Math.floor((attempts - triggerCount) / 3) + 1);
                triggerSpecialEffects(level);
            }
            
            const maxX = window.innerWidth - noBtn.offsetWidth - 20;
            const maxY = window.innerHeight - noBtn.offsetHeight - 20;
            noBtn.style.position = 'fixed';
            noBtn.style.left = Math.random() * maxX + 'px';
            noBtn.style.top = Math.random() * maxY + 'px';
            
            bumpYesButton(0.2);
            
            // ä¿ç•™å˜å°æ•ˆæœï¼Œä¸é‡ç½®transform
            
            createEmojiBurst(window.innerWidth / 2, window.innerHeight / 2);
            if (config.effects?.lightning) triggerLightning();
        }

        /** ç§»åŠ¨æ‹’ç»æŒ‰é’® */
        function moveNoButton(mouseX, mouseY) {
            if (config.triggerEffects?.runaway === false) return;
            const btnRect = noBtn.getBoundingClientRect();
            const btnCenterX = btnRect.left + btnRect.width / 2;
            const btnCenterY = btnRect.top + btnRect.height / 2;
            
            const distance = Math.sqrt((mouseX - btnCenterX) ** 2 + (mouseY - btnCenterY) ** 2);
            
            // ä½¿ç”¨é…ç½®çš„èº²é¿æ£€æµ‹èŒƒå›´ï¼Œé»˜è®¤100px
            const avoidDist = config.triggerEffects?.avoidDistance || 100;
            if (distance < avoidDist) {
                const now = Date.now();
                if (now - lastEscapeAt < ESCAPE_COOLDOWN_MS) return;
                lastEscapeAt = now;
                attempts++;
                counter.textContent = `æ‹’ç»å°è¯•æ¬¡æ•°: ${attempts}`;
                updateHint();
                
                const triggerCount = config.triggerEffects?.triggerCount || 5;
                
                // æ£€æŸ¥æ˜¯å¦æ¿€æ´»è§¦å‘ç‰¹æ•ˆ
                if (attempts >= triggerCount && !triggerActivated) {
                    triggerActivated = true;
                }
                
                // è§¦å‘ç‰¹æ•ˆ
                if (triggerActivated) {
                    const level = Math.min(5, Math.floor((attempts - triggerCount) / 3) + 1);
                    triggerSpecialEffects(level);
                }
                
                const maxX = window.innerWidth - btnRect.width - 20;
                const maxY = window.innerHeight - btnRect.height - 20;
                let newX = Math.random() * maxX;
                let newY = Math.random() * maxY;
                
                // æ¸è¿›å¢åŠ èº²é¿åˆ¤å®šè·ç¦»
                const avoidDistance = attempts >= triggerCount 
                    ? 200 + (attempts - triggerCount) * 30 
                    : 200;
                
                let count = 0;
                while (Math.sqrt((newX + btnRect.width/2 - mouseX) ** 2 + (newY + btnRect.height/2 - mouseY) ** 2) < avoidDistance && count < 10) {
                    newX = Math.random() * maxX;
                    newY = Math.random() * maxY;
                    count++;
                }
                
                noBtn.style.position = 'fixed';
                noBtn.style.left = newX + 'px';
                noBtn.style.top = newY + 'px';
                // ä¿ç•™å˜å°æ•ˆæœ
                const currentScale = noBtn._currentScale || 1;
                noBtn.style.transform = `scale(${currentScale})`;
                
                bumpYesButton(0.15);
                
                updateHint();
                createEmojiBurst(mouseX, mouseY);
                if (config.effects?.lightning) triggerLightning();
            }
        }

        /** æ›´æ–°æç¤º */
        function updateHint() {
            const hints = config.hints || defaultConfig.hints;
            let hintText = hints[Math.min(attempts, hints.length - 1)];
            hint.textContent = hintText.replace('{attempts}', attempts);
        }

        /** åŒæ„ */
        function sayYes() {
            vibrate(25);
            // ç§»é™¤äº‹ä»¶ç›‘å¬ï¼Œé˜²æ­¢æˆåŠŸåç»§ç»­è§¦å‘
            document.removeEventListener('mousemove', handleMouseMove);
            document.removeEventListener('touchstart', handleTouchStart);
            document.removeEventListener('touchmove', handleTouchMove);
            document.removeEventListener('touchend', handleTouchEnd);
            document.removeEventListener('touchcancel', clearLongPress);
            clearLongPress();
            
            document.getElementById('question-section').style.display = 'none';
            document.getElementById('success').style.display = 'flex';
            document.getElementById('attempts').textContent = attempts;
            counter.style.display = 'none';
            hint.style.display = 'none';
            
            // æ¸…ç†ç‰¹æ•ˆå…ƒç´ 
            clearTimeout(emojiBurstTimeout);
            multipleClones.forEach(clone => clone.remove());
            multipleClones = [];
            cloneWaveCount = 0;
            
            if (config.effects?.confetti) createConfetti();
            if (config.effects?.fireworks) startFireworks();
            if (config.effects?.hearts) setInterval(createHeart, 150);
        }

        /** é¼ æ ‡ç§»åŠ¨å¤„ç†å‡½æ•° - ä¿å­˜å¼•ç”¨ä»¥ä¾¿ç§»é™¤ */
        function handleMouseMove(e) {
            mouseX = e.clientX;
            mouseY = e.clientY;
            moveNoButton(e.clientX, e.clientY);
        }
        
        /** è§¦æ‘¸å¼€å§‹ï¼šæ‰‹æœºç«¯ç‚¹æŒ‰ä¹Ÿèƒ½è§¦å‘è¿½é€ */
        function handleTouchStart(e) {
            if (e.touches.length > 0) {
                const t = e.touches[0];
                mouseX = t.clientX;
                mouseY = t.clientY;
                touchStartX = t.clientX;
                touchStartY = t.clientY;
                longPressTriggered = false;

                moveNoButton(t.clientX, t.clientY);

                // é•¿æŒ‰æ‹’ç»æŒ‰é’®ï¼šæ›´ç¬¦åˆç§»åŠ¨ç«¯ç©æ³•
                const target = e.target;
                const onNoBtn = target === noBtn || (target && typeof target.closest === 'function' && target.closest('#noBtn'));
                if (onNoBtn) {
                    clearLongPress();
                    longPressTimer = setTimeout(() => {
                        longPressTriggered = true;
                        handleNoClick();
                        hint.textContent = 'ğŸ˜ˆ é•¿æŒ‰ä¹Ÿæ²¡ç”¨ï¼Œè¿˜æ˜¯æŠ“ä¸åˆ°æˆ‘~';
                    }, LONG_PRESS_MS);
                }
            }
            // é˜²æ­¢é¡µé¢æ»šåŠ¨å¯¼è‡´äº¤äº’å¤±çœŸ
            e.preventDefault();
        }

        /** è§¦æ‘¸ç§»åŠ¨å¤„ç†å‡½æ•° */
        function handleTouchMove(e) {
            if (e.touches.length > 0) {
                const t = e.touches[0];
                mouseX = t.clientX;
                mouseY = t.clientY;
                moveNoButton(t.clientX, t.clientY);

                // ç§»åŠ¨è·ç¦»å¤ªå¤§åˆ™å–æ¶ˆé•¿æŒ‰
                if (touchStartX !== null && touchStartY !== null) {
                    const dx = t.clientX - touchStartX;
                    const dy = t.clientY - touchStartY;
                    if (Math.hypot(dx, dy) > 18) clearLongPress();
                }
            }
            e.preventDefault();
        }

        /** è§¦æ‘¸ç»“æŸï¼šåŠ å…¥å·¦å³æ»‘ç©æ³• */
        function handleTouchEnd(e) {
            if (!isTouchDevice) return;

            const t = e.changedTouches && e.changedTouches[0];
            if (!t || touchStartX === null || touchStartY === null) {
                clearLongPress();
                return;
            }

            const dx = t.clientX - touchStartX;
            const dy = t.clientY - touchStartY;
            const absX = Math.abs(dx);
            const absY = Math.abs(dy);

            clearLongPress();

            // é•¿æŒ‰å·²ç»è§¦å‘å°±ä¸å†æ‰§è¡Œæ»‘åŠ¨é€»è¾‘
            if (longPressTriggered) {
                longPressTriggered = false;
                touchStartX = null;
                touchStartY = null;
                return;
            }

            // æ¨ªå‘æ»‘åŠ¨ä¼˜å…ˆï¼šå·¦æ»‘=ç»§ç»­æ‹’ç»æŒ‘æˆ˜ï¼›å³æ»‘=å¿«é€ŸåŒæ„
            if (absX > SWIPE_THRESHOLD && absX > absY * 1.2) {
                if (dx < 0) {
                    handleNoClick();
                    hint.textContent = 'ğŸ‘ˆ å·¦æ»‘æ‹’ç»ï¼Ÿæˆ‘ç»§ç»­èº²~';
                } else {
                    hint.textContent = 'ğŸ‘‰ å³æ»‘è¡¨ç¤ºå¿ƒåŠ¨ä¸­...';
                    setTimeout(sayYes, 120);
                }
                vibrate(18);
            }

            touchStartX = null;
            touchStartY = null;
            e.preventDefault();
        }

        /** å¯åŠ¨ç‰¹æ•ˆ */
        function startEffects() {
            const e = config.effects || defaultConfig.effects;
            // æ˜Ÿæ˜Ÿç‰¹æ•ˆç«‹å³å¯åŠ¨ï¼ˆè½»é‡çº§ï¼‰
            if (e.stars) createStars();
            // å…¶ä»–ç‰¹æ•ˆå»¶è¿Ÿå¯åŠ¨ï¼Œé¿å…é¡µé¢åŠ è½½å¡é¡¿
            if (e.hearts) setTimeout(() => setInterval(createHeart, 800), 500);
            if (e.bubbles) setTimeout(() => setInterval(createBubble, 500), 1000);
            if (e.snow) setTimeout(() => setInterval(createSnow, 300), 1500);
            if (e.petals) setTimeout(() => setInterval(createPetal, 600), 2000);
            if (e.meteor) setTimeout(() => setInterval(createMeteor, 2000), 2500);
        }

        /** è§¦å‘æ‹’ç»ç‰¹æ•ˆ - æ¸è¿›ç‰ˆæœ¬ */
        function triggerSpecialEffects(level = 1) {
            const te = config.triggerEffects || defaultConfig.triggerEffects;
            
            // éœ‡åŠ¨å±å¹• - æ¸è¿›å¢å¼º
            if (te.shake) {
                const duration = 300 + level * 100;
                document.body.style.animation = `shake-${level} ${duration}ms ease`;
                setTimeout(() => document.body.style.animation = '', duration);
            }
            
            // æ’­æ”¾éŸ³æ•ˆ - æ¸è¿›å˜åŒ–
            if (te.sound) {
                playRejectSound(level);
            }
            
            // å“­æ³£æ•ˆæœ - è§¦å‘åæ˜¾ç¤º
            if (te.cry) {
                noBtn.classList.add('btn-cry');
            }
            
            // åˆ†èº«æœ¯ - æ¸è¿›å¢åŠ ï¼Œæœ€å¤š3æ³¢
            if (te.multiple && cloneWaveCount < MAX_CLONE_WAVES) {
                createMultipleButtons(level);
                cloneWaveCount++;
            }
            
            // å˜å°æ•ˆæœ - æ¯æ¬¡è§¦å‘éƒ½å˜å°
            if (attempts >= 5) {
                const minScale = 0.15;
                const currentScale = noBtn._currentScale || 1;
                const newScale = Math.max(minScale, currentScale * 0.6);
                noBtn._currentScale = newScale;
                noBtn.style.transform = `scale(${newScale})`;
            }
            
            // éƒ¨åˆ†è—å…¥æ•ˆæœ - ç­‰çº§2ä»¥ä¸Šå¼€å§‹è—å…¥
            if (level >= 2) {
                partialHide(level);
            }
            
            // æ–°å¢è¶£å‘³æ•ˆæœ
            if (level >= 2) {
                // å¼¹å‡ºè°ƒçš®å¯¹è¯æ¡†
                showTrollDialog(level);
            }
            
            if (level >= 3) {
                // æŒ‰é’®æ–‡å­—å˜åŒ–
                const texts = ['å“¼ï¼', 'è®¨åŒï¼', 'ä¸è¦ï¼', 'å°±ä¸ï¼', 'ç•¥ç•¥ç•¥ï¼'];
                noBtn.textContent = texts[Math.min(level - 3, texts.length - 1)];
            }
            
            if (level >= 4) {
                // èƒŒæ™¯è‰²è­¦å‘Šå˜åŒ–
                document.body.style.background = `linear-gradient(135deg, 
                    hsl(${30 + level * 10}, 80%, 60%), 
                    hsl(${60 + level * 10}, 70%, 50%))`;
            }
        }
        
        // éƒ¨åˆ†è—å…¥å±‚çº§
        let hideLevel = 0;
        const MAX_HIDE_LEVEL = 4;
        
        /** éƒ¨åˆ†è—å…¥æ•ˆæœ */
        function partialHide(level) {
            hideLevel = Math.min(MAX_HIDE_LEVEL, level);
            
            const btnRect = noBtn.getBoundingClientRect();
            const btnWidth = btnRect.width;
            const btnHeight = btnRect.height;
            
            // è—å…¥æ¯”ä¾‹ï¼š1/4, 1/3, 1/2, 2/3 (æ›´åˆç†çš„è—å…¥æ¯”ä¾‹)
            const hideRatios = [0.25, 0.33, 0.5, 0.67];
            const hideRatio = hideRatios[Math.min(hideLevel - 1, hideRatios.length - 1)];
            
            const hideX = btnWidth * hideRatio;
            const hideY = btnHeight * hideRatio;
            
            // éšæœºé€‰æ‹©è—å…¥æ–¹å‘ï¼šä¸Šã€ä¸‹ã€å·¦ã€å³
            const directions = ['top', 'bottom', 'left', 'right'];
            const direction = directions[Math.floor(Math.random() * directions.length)];
            
            noBtn.style.zIndex = '999';
            
            // ä¿ç•™ç¼©å°æ•ˆæœ
            const currentScale = noBtn._currentScale || 1;
            
            switch(direction) {
                case 'top':
                    noBtn.style.top = (-hideY + 10) + 'px';
                    break;
                case 'bottom':
                    noBtn.style.top = (window.innerHeight - btnHeight + hideY - 10) + 'px';
                    break;
                case 'left':
                    noBtn.style.left = (-hideX + 10) + 'px';
                    break;
                case 'right':
                    noBtn.style.left = (window.innerWidth - btnWidth + hideX - 10) + 'px';
                    break;
            }
            
            // åº”ç”¨ç¼©å°æ•ˆæœ
            noBtn.style.transform = `scale(${currentScale})`;
        }
        
        // è°ƒçš®å¯¹è¯æ¡†ç›¸å…³å˜é‡
        let currentDialog = null;
        
        /** æ˜¾ç¤ºè°ƒçš®å¯¹è¯æ¡† */
        function showTrollDialog(level) {
            // ç§»é™¤æ—§å¯¹è¯æ¡†
            if (currentDialog) {
                currentDialog.remove();
            }
            
            const messages = [
                'å˜¿å˜¿ï¼ŒæŠ“ä¸åˆ°æˆ‘~ ğŸ¦Š',
                'å†è¯•ä¹Ÿæ²¡ç”¨çš„~ ğŸ˜œ',
                'æ”¾å¼ƒå§å°‘å¹´ï¼ğŸ’ª',
                'å“å‘€åˆç©ºäº†~ ğŸ¯',
                'ä½ æ°¸è¿œä¹Ÿç‚¹ä¸åˆ°ï¼âœ¨'
            ];
            
            const dialog = document.createElement('div');
            dialog.style.cssText = `
                position: fixed;
                top: ${Math.random() * 60 + 20}%;
                left: ${Math.random() * 60 + 20}%;
                background: rgba(255, 255, 255, 0.95);
                padding: 15px 25px;
                border-radius: 20px;
                box-shadow: 0 10px 40px rgba(0,0,0,0.3);
                font-size: 1.1rem;
                color: #333;
                z-index: 10000;
                animation: dialogPop 0.3s ease;
                font-family: 'Microsoft YaHei', sans-serif;
                max-width: 200px;
                text-align: center;
            `;
            dialog.textContent = messages[Math.min(level - 2, messages.length - 1)];
            
            // æ·»åŠ åŠ¨ç”»
            const style = document.createElement('style');
            style.textContent = `
                @keyframes dialogPop {
                    0% { transform: scale(0); opacity: 0; }
                    50% { transform: scale(1.1); }
                    100% { transform: scale(1); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(dialog);
            currentDialog = dialog;
            
            // 3ç§’åæ¶ˆå¤±
            setTimeout(() => {
                if (dialog && dialog.parentNode) {
                    dialog.style.transition = 'opacity 0.5s, transform 0.5s';
                    dialog.style.opacity = '0';
                    dialog.style.transform = 'scale(0.8)';
                    setTimeout(() => dialog.remove(), 500);
                }
            }, 3000);
        }

        /** æ’­æ”¾æ‹’ç»éŸ³æ•ˆ - æ¸è¿›ç‰ˆæœ¬ */
        function playRejectSound(level) {
            try {
                const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioCtx.createOscillator();
                const gainNode = audioCtx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);
                
                // é¢‘ç‡éšç­‰çº§å˜åŒ–
                const baseFreq = 300 - level * 30;
                oscillator.frequency.setValueAtTime(baseFreq, audioCtx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(baseFreq * 0.3, audioCtx.currentTime + 0.3);
                
                // éŸ³é‡éšç­‰çº§å¢åŠ 
                const volume = 0.2 + level * 0.08;
                gainNode.gain.setValueAtTime(volume, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                
                oscillator.start(audioCtx.currentTime);
                oscillator.stop(audioCtx.currentTime + 0.3);
            } catch (e) {}
        }

        /** åˆ›å»ºå¤šä¸ªåˆ†èº«æŒ‰é’® - è¯±é¥µç‰ˆæœ¬ */
        function createMultipleButtons(level) {
            // æ¸…é™¤æ—§çš„åˆ†èº«
            multipleClones.forEach(clone => {
                if (clone._moveInterval) clearInterval(clone._moveInterval);
                if (clone._hoverInterval) clearInterval(clone._hoverInterval);
                clone.remove();
            });
            multipleClones = [];
            
            // åˆ†èº«æ•°é‡ï¼š3-10ä¸ª
            const numClones = Math.min(3 + level * 2, 10);
            // é€ƒè·‘æ¬¡æ•°åå˜æˆåŒæ„ï¼š3-5æ¬¡ï¼Œç­‰çº§è¶Šé«˜è¶Šå¿«å±ˆæœ
            const escapeLimit = Math.max(3, 6 - level);
            
            for (let i = 0; i < numClones; i++) {
                const clone = noBtn.cloneNode(true);
                clone.id = '';
                clone.style.position = 'fixed';
                clone.style.left = Math.random() * (window.innerWidth - 120) + 'px';
                clone.style.top = Math.random() * (window.innerHeight - 60) + 'px';
                clone.style.transform = 'none';
                clone.style.zIndex = '1001';
                
                // åˆå§‹æ˜¾ç¤ºæ‹’ç»
                clone.textContent = 'æ‹’ç» ğŸ˜¢';
                clone.style.background = 'linear-gradient(45deg, #a8a8a8, #c0c0c0)';
                clone.style.boxShadow = '0 5px 20px rgba(0, 0, 0, 0.2)';
                
                // è¯±é¥µçŠ¶æ€
                clone._escapeCount = 0;
                clone._escapeLimit = escapeLimit;
                clone._isTamed = false;
                clone._createdTime = Date.now();
                // åˆå§‹å¿«é€Ÿé€ƒè·‘é€Ÿåº¦
                clone._escapeSpeed = Math.max(50, 150 - level * 15);
                
                // ç‚¹å‡»å¤„ç† - ç‚¹å‡»ç›´æ¥æˆåŠŸï¼ï¼ˆè¯±é¥µæ•ˆæœï¼‰
                clone.onclick = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    // ç‚¹å‡»è¯±é¥µç›´æ¥æˆåŠŸï¼
                    sayYes();
                };
                
                // é¼ æ ‡é è¿‘æ—¶å¤„ç†
                const checkDistance = () => {
                    if (!document.contains(clone)) {
                        if (clone._hoverInterval) clearInterval(clone._hoverInterval);
                        return;
                    }
                    
                    const rect = clone.getBoundingClientRect();
                    const cloneX = rect.left + rect.width / 2;
                    const cloneY = rect.top + rect.height / 2;
                    
                    const distance = Math.sqrt((mouseX - cloneX) ** 2 + (mouseY - cloneY) ** 2);
                    
                    // å¦‚æœå·²è¢«"é©¯æœ"ï¼Œä¸å†é€ƒè·‘ï¼Œåªåšè¯±é¥µ
                    if (clone._isTamed) {
                        if (distance < 120) {
                            clone.textContent = 'å¥½çš„ â¤ï¸';
                            clone.style.background = 'linear-gradient(45deg, #4CAF50, #8BC34A)';
                            clone.style.boxShadow = '0 5px 20px rgba(76, 175, 80, 0.5)';
                        } else {
                            clone.textContent = 'æ‹’ç» ğŸ˜¢';
                            clone.style.background = 'linear-gradient(45deg, #a8a8a8, #c0c0c0)';
                            clone.style.boxShadow = '0 5px 20px rgba(0, 0, 0, 0.2)';
                        }
                        return;
                    }
                    
                    // é€ƒè·‘æ¨¡å¼ï¼šè·ç¦»<60å°±é€ƒè·‘
                    if (distance < 60) {
                        clone._escapeCount++;
                        
                        // è¾¾åˆ°é€ƒè·‘æ¬¡æ•°åï¼Œé©¯æœå®ƒï¼
                        if (clone._escapeCount >= clone._escapeLimit) {
                            clone._isTamed = true;
                            // é©¯æœæ—¶ç»™ä¸€ä¸ªç”œèœœçš„åŠ¨ç”»
                            clone.style.transition = 'all 0.3s ease';
                            clone.textContent = 'å¥½çš„ â¤ï¸';
                            clone.style.background = 'linear-gradient(45deg, #4CAF50, #8BC34A)';
                            clone.style.boxShadow = '0 5px 20px rgba(76, 175, 80, 0.5)';
                            return;
                        }
                        
                        // æ¯æ¬¡é€ƒè·‘é€Ÿåº¦å˜æ…¢
                        clone._escapeSpeed = Math.min(300, clone._escapeSpeed + 30);
                        
                        const maxX = window.innerWidth - 120;
                        const maxY = window.innerHeight - 60;
                        clone.style.transition = `all ${clone._escapeSpeed}ms ease`;
                        clone.style.left = Math.random() * maxX + 'px';
                        clone.style.top = Math.random() * maxY + 'px';
                    }
                    
                    // è·ç¦»<120æ—¶æ˜¾ç¤ºè¯±é¥µæ„å›¾
                    if (distance < 120) {
                        // é€ƒè·‘ä¸­æ˜¾ç¤ºè­¦å‘Š
                        if (clone._escapeCount > 0) {
                            clone.textContent = 'å“¼ï¼ğŸ˜ ';
                            clone.style.background = 'linear-gradient(45deg, #ff6b6b, #ff8e8e)';
                        }
                    } else {
                        clone.textContent = 'æ‹’ç» ğŸ˜¢';
                        clone.style.background = 'linear-gradient(45deg, #a8a8a8, #c0c0c0)';
                    }
                };
                
                clone._hoverInterval = setInterval(checkDistance, 100);
                
                document.body.appendChild(clone);
                multipleClones.push(clone);
                
                // 8ç§’åè‡ªåŠ¨æ¶ˆå¤±
                setTimeout(() => {
                    if (document.contains(clone)) {
                        clone.style.transition = 'opacity 0.5s, transform 0.5s';
                        clone.style.opacity = '0';
                        clone.style.transform = 'scale(0)';
                        setTimeout(() => {
                            if (clone._hoverInterval) clearInterval(clone._hoverInterval);
                            clone.remove();
                            const idx = multipleClones.indexOf(clone);
                            if (idx > -1) multipleClones.splice(idx, 1);
                        }, 500);
                    }
                }, 8000);
            }
        }

        /** åˆ›å»ºç‰¹æ•ˆå‡½æ•° */
        function createStars() {
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                document.body.appendChild(star);
            }
        }

        function createHeart() {
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.innerHTML = ['ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’', 'â¤ï¸', 'ğŸ’˜'][Math.floor(Math.random() * 6)];
            heart.style.left = Math.random() * 100 + '%';
            heart.style.animationDuration = (Math.random() * 3 + 2) + 's';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 5000);
        }

        function createEmojiBurst(x, y) {
            const emojis = ['ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'âœ¨', 'ğŸ‰', 'â¤ï¸', 'ğŸ’', 'ğŸ’«'];
            for (let i = 0; i < 8; i++) {
                const emoji = document.createElement('div');
                emoji.className = 'emoji-burst';
                emoji.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
                emoji.style.left = (x + (Math.random() - 0.5) * 100) + 'px';
                emoji.style.top = (y + (Math.random() - 0.5) * 100) + 'px';
                document.body.appendChild(emoji);
                setTimeout(() => emoji.remove(), 1000);
            }
        }

        function createConfetti() {
            const colors = ['#ff6b6b', '#ffd93d', '#6bcb77', '#4d96ff', '#c9b1ff'];
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const c = document.createElement('div');
                    c.className = 'confetti';
                    c.style.left = Math.random() * 100 + '%';
                    c.style.background = colors[Math.floor(Math.random() * colors.length)];
                    c.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                    document.body.appendChild(c);
                    setTimeout(() => c.remove(), 3000);
                }, i * 30);
            }
        }

        function createBubble() {
            const bubble = document.createElement('div');
            bubble.className = 'bubble';
            bubble.style.left = Math.random() * 100 + '%';
            const size = Math.random() * 20 + 10;
            bubble.style.width = size + 'px';
            bubble.style.height = size + 'px';
            bubble.style.animationDuration = (Math.random() * 3 + 3) + 's';
            document.body.appendChild(bubble);
            setTimeout(() => bubble.remove(), 4000);
        }

        function createSnow() {
            const snow = document.createElement('div');
            snow.className = 'snow';
            snow.innerHTML = 'â„';
            snow.style.left = Math.random() * 100 + '%';
            snow.style.fontSize = (Math.random() * 15 + 10) + 'px';
            snow.style.animationDuration = (Math.random() * 3 + 4) + 's';
            document.body.appendChild(snow);
            setTimeout(() => snow.remove(), 7000);
        }

        function createPetal() {
            const petal = document.createElement('div');
            petal.className = 'petal';
            petal.innerHTML = ['ğŸŒ¸', 'ğŸŒº', 'ğŸŒ·', 'ğŸŒ¹'][Math.floor(Math.random() * 4)];
            petal.style.left = Math.random() * 100 + '%';
            petal.style.animationDuration = (Math.random() * 4 + 3) + 's';
            document.body.appendChild(petal);
            setTimeout(() => petal.remove(), 7000);
        }

        function createMeteor() {
            const meteor = document.createElement('div');
            meteor.className = 'meteor';
            meteor.style.left = Math.random() * 100 + '%';
            meteor.style.top = '-100px';
            document.body.appendChild(meteor);
            setTimeout(() => meteor.remove(), 1000);
        }

        function triggerLightning() {
            const lightning = document.getElementById('lightning');
            lightning.classList.remove('flash');
            void lightning.offsetWidth;
            lightning.classList.add('flash');
        }

        function startFireworks() {
            const colors = ['#ff6b6b', '#ffd93d', '#6bcb77', '#4d96ff', '#c9b1ff'];
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const fw = document.createElement('div');
                    fw.className = 'firework';
                    fw.style.left = Math.random() * 100 + '%';
                    fw.style.top = (Math.random() * 40 + 20) + '%';
                    fw.style.background = colors[Math.floor(Math.random() * colors.length)];
                    fw.style.boxShadow = `0 0 20px ${fw.style.background}`;
                    document.body.appendChild(fw);
                    setTimeout(() => fw.remove(), 1000);
                }, i * 200);
            }
        }

        init();
    </script>
</body>
</html>
